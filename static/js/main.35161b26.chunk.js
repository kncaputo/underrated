(this.webpackJsonpunderrated=this.webpackJsonpunderrated||[]).push([[0],{100:function(e,t,n){"use strict";n.r(t);var r=n(1),s=n(0),a=n(21),i=n.n(a),c=n(18),o=(n(59),n(12)),l=n(13),u=n(15),h=n(14),d=n(48),j=(n(60),n(61),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).determineError=function(){if(e.props.error)return Object(r.jsx)("section",{children:Object(r.jsx)("p",{children:e.props.error})})},e.submitLogin=function(){e.props.validateLogin(e.state.email,e.state.password),e.clearInputs()},e.clearInputs=function(){e.setState({email:"",password:""})},e.state={email:"",password:""},e}return Object(l.a)(n,[{key:"handleClick",value:function(e){e.preventDefault()}},{key:"handleChange",value:function(e){this.props.clearError(),this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("section",{id:"login-main",children:[Object(r.jsx)("input",{name:"email",type:"text",placeholder:"Email",className:"login-input",value:this.state.email,onClick:function(t){return e.handleClick(t)},onChange:function(t){return e.handleChange(t)}}),Object(r.jsx)("input",{name:"password",type:"password",placeholder:"Password",value:this.state.password,onClick:function(t){return e.handleClick(t)},onChange:function(t){return e.handleChange(t)}}),this.determineError(),Object(r.jsx)("button",{id:"submit-button",onClick:this.submitLogin,children:"SUBMIT"})]})}}]),n}(s.Component)),m=n(23),p=(n(62),function(e){var t=e.currentUser,n=e.validateLogin,s=e.error,a=e.clearError,i=e.signOut;return Object(r.jsxs)("header",{children:[Object(r.jsx)(c.b,{to:"/",children:Object(r.jsx)("h1",{className:"page-title",children:"underrated"})}),Object(r.jsxs)("nav",{children:[Object(r.jsx)(c.c,{exact:!0,to:"/",className:"nav-labels",children:"all movies"}),Object(r.jsx)(c.c,{exact:!0,to:"/watchlist",className:"nav-labels",children:"watchlist"}),Object(r.jsxs)(m.a,{className:"nav-labels",title:"account",size:"lg",children:[!t&&Object(r.jsx)(j,{validateLogin:n,error:s,clearError:a}),t&&Object(r.jsxs)("section",{children:[Object(r.jsxs)("p",{id:"user-message",children:["Hello, ",t.name,"!"]}),Object(r.jsx)("button",{id:"sign-out",onClick:i,children:"Sign Out"})]})]})]})]})}),g=(n(69),function(e){var t=e.id,n=e.title,s=e.rating,a=e.image;return Object(r.jsx)(c.b,{to:"/movie/".concat(t),children:Object(r.jsxs)("section",{className:"poster",id:t,children:[Object(r.jsx)("img",{className:"card-img",src:a,alt:n}),Object(r.jsx)("p",{className:"poster-title",children:n}),Object(r.jsxs)("p",{className:"poster-rating",children:["\u2606 ",s.toFixed(1),"/10"]}),Object(r.jsxs)("p",{className:"poster-rating-mini",children:["\u2606 ",s.toFixed(1),"/10"]})]})})}),b=(n(70),function(e){var t=e.movies.map((function(e){return Object(r.jsx)(g,{id:e.id,title:e.title,rating:e.average_rating,image:e.poster_path},e.id)}));return Object(r.jsx)("section",{className:"movie-grid",children:t})}),f="https://rancid-tomatillos.herokuapp.com/api/v2",v=function(e){return fetch("".concat(f,"/movies/").concat(+e)).then((function(e){return e.json()}))},O=function(e){return fetch("".concat(f,"/movies/").concat(+e,"/videos")).then((function(e){return e.json()}))},x=(n(71),function(e){var t=e.label,n=e.body;return Object(r.jsxs)("section",{className:"details-box",children:[Object(r.jsx)("p",{className:"l-details",children:Object(r.jsx)("b",{children:t})}),Object(r.jsx)("p",{className:"r-details",children:"$0"===n?"-":n})]})}),w=n(50),N=n(51),y=n.n(N),S=(n(91),n(92),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).determineAvailableTrailers=function(){return e.state.trailers.find((function(e){return"YouTube"===e.site}))},e.formatTrailers=function(){return e.state.trailers.map((function(e){if("YouTube"===e.site)return Object(r.jsx)(y.a,{"data-testid":e.id,url:"https://www.youtube.com/watch?v=".concat(e.key)},e.id)}))},e.state={trailers:[],error:""},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;O(this.props.id).then((function(t){return e.setState({trailers:t.videos})})).catch((function(t){return e.setState({error:t.message})}))}},{key:"render",value:function(){return Object(r.jsxs)("section",{className:"trailers",children:[this.determineAvailableTrailers()&&Object(r.jsx)(w.Carousel,{showThumbs:!1,children:this.formatTrailers()}),!this.determineAvailableTrailers()&&Object(r.jsx)("p",{children:"Sorry, no available trailers for this movie."})]})}}]),n}(s.Component)),U=n(52),C=n.n(U),k=function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).handleStarChange=function(t){e.setState({rating:t}),e.props.setStarRating(t)},e.state={rating:0},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.setState({rating:this.props.currentUserRating})}},{key:"componentDidUpdate",value:function(e){this.props.currentUserRating!==e.currentUserRating&&this.setState({rating:this.props.currentUserRating})}},{key:"handleRatingText",value:function(){return null===this.props.currentUser?Object(r.jsx)("p",{children:"Please log in to rate"}):0===this.props.currentUserRating?Object(r.jsx)("p",{children:"Rate this movie"}):Object(r.jsxs)("p",{children:["Your rating is ",this.state.rating]})}},{key:"render",value:function(){return Object(r.jsxs)("section",{children:[this.handleRatingText(),Object(r.jsx)(C.a,{value:this.state.rating,edit:this.props.canEdit,count:10,onChange:this.handleStarChange,size:24,activeColor:"#ffd700"},Math.random())]})}}]),n}(s.Component),R=(n(95),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).setStarRating=function(t){var n,r;e.props.currentUser&&e.state.currentUserRating?(n=e.state.currentUserRating.id,function(e,t){return fetch("".concat(f,"/users/").concat(+e,"/ratings/").concat(+t),{method:"DELETE",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()}))}(r=e.props.currentUser.id,n).catch((function(t){return e.setState({error:t.message})})),e.createNewRating(r,t)):e.props.currentUser&&(r=e.props.currentUser.id,e.createNewRating(r,t))},e.createNewRating=function(t,n){(function(e,t){return fetch("".concat(f,"/users/").concat(e,"/ratings"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()}))})(t,{movie_id:e.state.singleMovie.id,rating:+n}).then((function(){return e.updateUserRating()})).catch((function(t){return e.setState({error:t.message})}))},e.updateUserRating=function(){var t;(t=e.props.currentUser.id,fetch("".concat(f,"/users/").concat(+t,"/ratings")).then((function(e){return e.json()}))).then((function(t){var n=t.ratings.find((function(t){return t.movie_id===e.state.singleMovie.id}));e.setState({currentUserRating:n})})).catch((function(t){return e.setState({error:t.message})}))},e.formatGenres=function(){return e.state.singleMovie.genres?e.state.singleMovie.genres.length>1?e.state.singleMovie.genres.map((function(e){return Object(r.jsx)("p",{className:"genre",children:e},Math.random())})):Object(r.jsx)("p",{className:"genre",children:e.state.singleMovie.genres[0]}):Object(r.jsx)("p",{className:"unavailable-genres",children:"Unavailable"})},e.toggleWatchlist=function(){!1===e.state.onWatchlist?e.setState({onWatchlist:!0}):e.setState({onWatchlist:!1})},e.state={singleMovie:{},error:"",currentUserRating:null,onWatchlist:!1},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;window.scrollTo(0,0),v(this.props.id).then((function(t){return e.setState({singleMovie:t.movie})})).then((function(){return e.getUserRatings()})).catch((function(t){return e.setState({error:t.message})}))}},{key:"componentDidUpdate",value:function(e){window.scrollTo(0,0),e.currentUser!==this.props.currentUser&&(this.setState({currentUserRating:null,error:""}),this.getUserRatings())}},{key:"getUserRatings",value:function(){this.setState({formattedRating:this.state.singleMovie.average_rating.toFixed(1)}),this.props.currentUser&&this.updateUserRating()}},{key:"generateListItem",value:function(){return Object(r.jsxs)("section",{children:[Object(r.jsx)(x,{label:"Release Date",body:new Date(this.state.singleMovie.release_date).toLocaleDateString()},Math.random()),Object(r.jsx)(x,{label:"Runtime",body:"".concat(this.state.singleMovie.runtime," mins")},Math.random()),Object(r.jsx)(x,{label:"Budget",body:"$".concat(new Intl.NumberFormat("en-US").format(this.state.singleMovie.budget))},Math.random()),Object(r.jsx)(x,{label:"Revenue",body:"$".concat(new Intl.NumberFormat("en-US").format(this.state.singleMovie.revenue))},Math.random())]})}},{key:"render",value:function(){var e=this;return Object(r.jsxs)("section",{className:"movie-details",children:[Object(r.jsx)("section",{className:"banner-container",children:Object(r.jsx)("img",{src:this.state.singleMovie.backdrop_path,className:"banner-img"})}),Object(r.jsxs)("section",{className:"movie-info",children:[Object(r.jsxs)("section",{className:"movie-aside",children:[Object(r.jsx)("img",{src:this.state.singleMovie.poster_path,className:"poster-img"}),this.generateListItem()]}),Object(r.jsxs)("section",{className:"movie-main",children:[Object(r.jsxs)("section",{className:"backdrop-overlay",children:[Object(r.jsx)("section",{className:"responsive-poster",children:Object(r.jsx)("img",{src:this.state.singleMovie.poster_path,className:"poster-img"})}),Object(r.jsxs)("section",{className:"main-header-details",children:[Object(r.jsx)("h1",{className:"title",children:this.state.singleMovie.title}),Object(r.jsx)("p",{className:"tagline",children:this.state.singleMovie.tagline}),Object(r.jsxs)("p",{className:"rating",children:[Object(r.jsxs)("span",{className:"rating-star",children:["\u2606 ",this.state.formattedRating]}),"/10"]}),Object(r.jsx)("section",{className:"genre-list",children:this.formatGenres()})]})]}),Object(r.jsxs)("section",{className:"overview-box",children:[Object(r.jsxs)("section",{className:"rating-watchlist",children:[Object(r.jsx)(k,{currentUser:this.props.currentUser,currentUserRating:this.state.currentUserRating?this.state.currentUserRating.rating:0,canEdit:!!this.props.currentUser,setStarRating:this.setStarRating}),!0===this.state.onWatchlist&&Object(r.jsx)("button",{className:"on-watchlist-button",onClick:function(){return e.toggleWatchlist()},children:"On Watchlist"}),!1===this.state.onWatchlist&&Object(r.jsx)("button",{className:"add-watchlist-button",onClick:function(){return e.toggleWatchlist()},children:"+ Add to Watchlist"})]}),Object(r.jsx)("section",{className:"responsive-genre-list",children:this.formatGenres()}),Object(r.jsx)("h3",{children:"Synopsis"}),Object(r.jsx)("p",{className:"overview",children:this.state.singleMovie.overview}),Object(r.jsx)("section",{className:"responsive-list",children:this.generateListItem()})]}),Object(r.jsxs)("section",{className:"trailer-box",children:[Object(r.jsx)("h3",{className:"trailer-header",children:"Trailers"}),Object(r.jsx)(S,{id:this.props.id})]})]})]})]})}}]),n}(s.Component)),M=(n(96),function(e){return Object(r.jsx)("input",{onChange:function(t){t.preventDefault(),e.getUserInput(t.target.value)},type:"text",value:e.input,placeholder:"\ud83d\udd0d search by movie title",className:"search-bar"})}),T=n(53),V=n.n(T),D=(n(97),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).displayTrailer=function(){var t=e.state.trailers.videos.find((function(e){return"YouTube"===e.site}));if(t)return Object(r.jsx)("div",{className:"player-wrapper",children:Object(r.jsx)(V.a,{url:"https://www.youtube.com/watch?v=".concat(t.key),className:"react-player",width:"100%",height:"100%",controls:!1,muted:!0,playing:!0,loop:!0,config:{youtube:{playerVars:{disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}}}},t.id)})},e.state={currentMovie:null,trailers:null,error:""},e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;O(337401).then((function(t){return e.setState({trailers:t})})).catch((function(t){return e.setState({error:t.message})}))}},{key:"render",value:function(){return Object(r.jsxs)("section",{children:[!this.state.trailers&&Object(r.jsx)("p",{children:"Loading..."}),this.state.trailers&&this.displayTrailer()]})}}]),n}(s.Component)),L=(n(98),function(){return Object(r.jsx)("section",{id:"watchlist-main",children:Object(r.jsx)("h2",{id:"section-title",children:"Coming Soon!"})})}),E=n(5),I=(n(99),function(e){Object(u.a)(n,e);var t=Object(h.a)(n);function n(){var e;return Object(o.a)(this,n),(e=t.call(this)).componentDidMount=function(){fetch("".concat(f,"/movies")).then((function(e){return e.json()})).then((function(t){return e.setState({movies:t.movies})})).then((function(){return e.findMovieGenres()})).catch((function(t){return e.setState({error:t.message})}))},e.findMovieGenres=function(){e.state.movies.map((function(e){v(e.id).then((function(t){return e.genres=t.movie.genres}))}))},e.validateLogin=function(t,n){var r;(r={email:t,password:n},fetch("".concat(f,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}).then((function(e){return e.json()}))).then((function(t){return e.setState({currentUser:t.user})})).catch((function(t){return e.setState({error:t.message})}))},e.clearError=function(){e.setState({error:""})},e.signOut=function(){e.setState({currentUser:null})},e.getUserInput=function(t){e.setState({input:t})},e.handleDropdownValue=function(t){e.setState({dropdownValue:t.target.name})},e.handleRatingValue=function(t){e.setState({ratingValue:t.target.value})},e.clearFilters=function(){e.setState({input:"",dropdownValue:"all",ratingValue:"any"})},e.generateGenreButtons=function(){return["Adventure","Animation","Comedy","Crime","Drama","Family","Fantasy","History","Horror","Music","Romance","Science","Thriller","War","Western"].map((function(t){return Object(r.jsx)("button",{name:t,className:"dropdown-filter",onClick:function(t){return e.handleDropdownValue(t)},children:t.toLowerCase()})}))},e.generateRatingsButtons=function(){return[{name:"one",value:1},{name:"two",value:2},{name:"three",value:3},{name:"four",value:4},{name:"five",value:5},{name:"six",value:6},{name:"seven",value:7},{name:"eight",value:8},{name:"nine",value:9},{name:"ten",value:10}].map((function(t){return Object(r.jsx)("button",{name:t.name,value:t.value,className:"dropdown-filter",onClick:function(t){return e.handleRatingValue(t)},children:t.name})}))},e.generateFilterDropdown=function(){return Object(r.jsxs)("section",{className:"genre-filter",children:[Object(r.jsx)("section",{className:"filter-title-box",children:Object(r.jsxs)(m.a,{title:"showing ".concat(e.state.dropdownValue.toUpperCase()," movies"),className:"genre-dropdown",id:"filter-title-l",children:[Object(r.jsx)("button",{className:"dropdown-filter",onClick:function(){return e.setState({dropdownValue:"all"})},children:"all"}),e.generateGenreButtons()]})}),Object(r.jsx)("section",{className:"filter-title-box",children:Object(r.jsx)(m.a,{title:"with ".concat(e.state.ratingValue.toUpperCase()," rating"),className:"rating-dropdown",id:"filter-title-r",children:e.generateRatingsButtons()})}),(""!==e.state.input||"all"!==e.state.dropdownValue||"any"!==e.state.ratingValue)&&Object(r.jsx)("button",{className:"clear",onClick:function(){return e.clearFilters()},children:"clear"})]})},e.state={movies:[],error:"",currentUser:null,input:"",dropdownValue:"all",ratingValue:"any"},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(r.jsxs)("main",{children:[Object(r.jsx)(p,{currentUser:this.state.currentUser,validateLogin:this.validateLogin,error:this.state.error,clearError:this.clearError,signOut:this.signOut}),Object(r.jsx)(E.a,{exact:!0,path:"/",render:function(){return Object(r.jsxs)("section",{children:[Object(r.jsx)(D,{}),Object(r.jsx)(M,{getUserInput:e.getUserInput,input:e.state.input}),e.generateFilterDropdown(),Object(r.jsx)(b,{movies:e.filterMoviesBySelection})]})}}),Object(r.jsx)(E.a,{exact:!0,path:"/movie/:id",render:function(t){var n=t.match;return Object(r.jsx)(R,{id:n.params.id,currentUser:e.state.currentUser})}}),Object(r.jsx)(E.a,{exact:!0,path:"/watchlist",component:L})]})}},{key:"filterMoviesBySelection",get:function(){var e=this,t=this.state.movies.filter((function(t){return"all"!==e.state.dropdownValue&&t.genres?t.genres.includes(e.state.dropdownValue):e.state.movies}));return t.filter((function(n){return"any"!==e.state.ratingValue?parseInt(n.average_rating)===parseInt(e.state.ratingValue):t})).filter((function(t){return t.title.toLowerCase().includes(e.state.input)}))}}]),n}(s.Component)),W=Object(r.jsx)(c.a,{basename:"/underrated",children:Object(r.jsx)(I,{})});i.a.render(W,document.getElementById("root"))},59:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},92:function(e,t,n){},95:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){},98:function(e,t,n){},99:function(e,t,n){}},[[100,1,2]]]);
//# sourceMappingURL=main.35161b26.chunk.js.map